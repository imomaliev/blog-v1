<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<link rel=icon href=/favicon.ico>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Blog</title>
<link rel=stylesheet href="/blog/css/main.min.076f25f16802c9ec06660a6a121a92d29518837ffb3f3129a7f2a1e7ed8ae34c.css">
</head>
<body><header>
<nav class=nav>
<ul>
<a class=nav-item href=https://imomaliev.github.io/blog/>Blog</a>
|
<a class=nav-item href=/blog/tils/ title=TILs>TILs</a>
</ul>
</nav>
</header>
<div id=content>
<article>
<h1 class="text-5xl font-bold">Git | Commit Short Sha Length</h1>
<h2 id=question>Question</h2>
<p>I was trying to match local build behavior to gitlab&rsquo;s one. In gitlab CI there is predifined variable called <code>CI_COMMIT_SHORT_SHA</code> which has a value of first 8 characters of current commit. To get &ldquo;short&rdquo; version of current commit you could run</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console>$ git rev-parse --short HEAD
e0c8af0
</code></pre></div><p>But this gives you only 7. First of all why it is 7 and how to get 8?</p>
<h2 id=answer>Answer</h2>
<ol>
<li>
<p>You could pass <code>{n}</code> to <code>--short</code>.</p>
<blockquote>
<p>&ndash;short[=length]
Same as &ndash;verify but shortens the object name to a unique prefix with at least length characters. The minimum length is 4, the default is the
effective value of the core.abbrev configuration variable (see git-config(1)).</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console>$ git rev-parse --short<span style=color:#f92672>=</span><span style=color:#ae81ff>8</span> HEAD
e0c8af03
</code></pre></div></li>
<li>
<p>There is <code>core.abbrev</code> setting for git config.</p>
<blockquote>
<p>core.abbrev
Set the length object names are abbreviated to. If unspecified or set to &ldquo;auto&rdquo;, an appropriate value is computed based on the approximate number
of packed objects in your repository, which hopefully is enough for abbreviated object names to stay unique for some time. The minimum length is 4.</p>
</blockquote>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console>$ git config core.abbrev <span style=color:#ae81ff>8</span>
</code></pre></div></li>
</ol>
<h2 id=what-i-learned>What I Learned</h2>
<ol>
<li>
<p>7 is somewhat default for many programms</p>
<p><a href=http://manpages.ubuntu.com/manpages/precise/en/man1/git-config.1.html>http://manpages.ubuntu.com/manpages/precise/en/man1/git-config.1.html</a></p>
<blockquote>
<p>core.abbrev
Set the length object names are abbreviated to. If unspecified, many commands
abbreviate to 7 hexdigits, which may not be enough for abbreviated object names to
stay unique for sufficiently long time.</p>
</blockquote>
</li>
</ol>
</article>
</div></body>
</html>