<!doctype html><html lang=en><head><meta charset=utf-8><link rel=icon href=/favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><title>Blog</title><link rel=stylesheet href="/blog/css/main.min.0a1265f87d82ecc5f08f9855f888f820ab77c67e51ba121bafdccbb5c3ddae79.css"></head><body><header><nav><ul><a class="text-lg font-bold text-cyan-600" href=/blog/ title=Blog>Blog</a>
|
<a class="underline
text-lg font-bold text-cyan-600" href=/blog/tils/ title=TILs>TILs</a></ul></nav></header><div id=content><article class="prose prose-sm sm:prose-base lg:prose-lg xl:prose-xl 2xl:prose-2xl
prose-cyan mx-auto"><h1>Centos | 8.3 Failed To Find Iptables</h1><h2 id=question>Question</h2><p>Trying to install docker on CentOS 8.3, but for some reason systemd kept giving me errors</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ systemctl status docker.service
</span></span><span style=display:flex><span>‚óè docker.service - Docker Application Container Engine
</span></span><span style=display:flex><span>   Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled)
</span></span><span style=display:flex><span>   Active: activating (auto-restart) (Result: exit-code) since Thu 2021-02-25 04:59:07 UTC; 918ms ago
</span></span><span style=display:flex><span>     Docs: https://docs.docker.com
</span></span><span style=display:flex><span>  Process: 1285 ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock (code=exited, status=1/FAILURE)
</span></span><span style=display:flex><span> Main PID: 1285 (code=exited, status=1/FAILURE)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>Feb 25 04:59:07 yasnoponyatno systemd[1]: docker.service: Main process exited, code=exited, status=1/FAILURE
</span></span><span style=display:flex><span>Feb 25 04:59:07 yasnoponyatno systemd[1]: docker.service: Failed with result &#39;exit-code&#39;.
</span></span><span style=display:flex><span>Feb 25 04:59:07 yasnoponyatno systemd[1]: Failed to start Docker Application Container Engine.
</span></span></code></pre></div><p>And</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ journalctl -xe
</span></span><span style=display:flex><span>Feb 25 04:59:09 yasnoponyatno systemd[1]: docker.service: Main process exited, code=exited, status=1/FAILURE
</span></span><span style=display:flex><span>Feb 25 04:59:09 yasnoponyatno systemd[1]: docker.service: Failed with result &#39;exit-code&#39;.
</span></span><span style=display:flex><span>-- Subject: Unit failed
</span></span><span style=display:flex><span>-- Defined-By: systemd
</span></span><span style=display:flex><span>-- Support: https://access.redhat.com/support
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- The unit docker.service has entered the &#39;failed&#39; state with result &#39;exit-code&#39;.
</span></span><span style=display:flex><span>Feb 25 04:59:09 yasnoponyatno systemd[1]: Failed to start Docker Application Container Engine.
</span></span><span style=display:flex><span>-- Subject: Unit docker.service has failed
</span></span><span style=display:flex><span>-- Defined-By: systemd
</span></span><span style=display:flex><span>-- Support: https://access.redhat.com/support
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- Unit docker.service has failed.
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- The result is failed.
</span></span><span style=display:flex><span>Feb 25 04:59:11 yasnoponyatno systemd[1]: docker.service: Service RestartSec=2s expired, scheduling restart.
</span></span><span style=display:flex><span>Feb 25 04:59:11 yasnoponyatno systemd[1]: docker.service: Scheduled restart job, restart counter is at 3.
</span></span><span style=display:flex><span>-- Subject: Automatic restarting of a unit has been scheduled
</span></span><span style=display:flex><span>-- Defined-By: systemd
</span></span><span style=display:flex><span>-- Support: https://access.redhat.com/support
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- Automatic restarting of the unit docker.service has been scheduled, as the result for
</span></span><span style=display:flex><span>-- the configured Restart= setting for the unit.
</span></span><span style=display:flex><span>Feb 25 04:59:11 yasnoponyatno systemd[1]: Stopped Docker Application Container Engine.
</span></span><span style=display:flex><span>-- Subject: Unit docker.service has finished shutting down
</span></span><span style=display:flex><span>-- Defined-By: systemd
</span></span><span style=display:flex><span>-- Support: https://access.redhat.com/support
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- Unit docker.service has finished shutting down.
</span></span><span style=display:flex><span>Feb 25 04:59:11 yasnoponyatno systemd[1]: docker.service: Start request repeated too quickly.
</span></span><span style=display:flex><span>Feb 25 04:59:11 yasnoponyatno systemd[1]: docker.service: Failed with result &#39;exit-code&#39;.
</span></span><span style=display:flex><span>-- Subject: Unit failed
</span></span><span style=display:flex><span>-- Defined-By: systemd
</span></span><span style=display:flex><span>-- Support: https://access.redhat.com/support
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- The unit docker.service has entered the &#39;failed&#39; state with result &#39;exit-code&#39;.
</span></span><span style=display:flex><span>Feb 25 04:59:11 yasnoponyatno systemd[1]: Failed to start Docker Application Container Engine.
</span></span><span style=display:flex><span>-- Subject: Unit docker.service has failed
</span></span><span style=display:flex><span>-- Defined-By: systemd
</span></span><span style=display:flex><span>-- Support: https://access.redhat.com/support
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- Unit docker.service has failed.
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- The result is failed.
</span></span><span style=display:flex><span>Feb 25 04:59:11 yasnoponyatno systemd[1]: docker.socket: Failed with result &#39;service-start-limit-hit&#39;.
</span></span><span style=display:flex><span>-- Subject: Unit failed
</span></span><span style=display:flex><span>-- Defined-By: systemd
</span></span><span style=display:flex><span>-- Support: https://access.redhat.com/support
</span></span><span style=display:flex><span>--
</span></span><span style=display:flex><span>-- The unit docker.socket has entered the &#39;failed&#39; state with result &#39;service-start-limit-hit&#39;.
</span></span></code></pre></div><h2 id=answer>Answer</h2><p>Install iptables</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>dnf install iptables
</span></span></code></pre></div><h2 id=what-i-learned>What I Learned</h2><ol><li><code>iptables</code> is bolted into docker internals
<a href=https://github.com/moby/moby/issues/26824>https://github.com/moby/moby/issues/26824</a></li><li>When installing iptables in CentOS 8 it actually installs shim script which converts <code>iptables</code>&rsquo;s commands to <code>nf_tables</code></li><li>Many Linux distros moving to nf_tables
<a href=https://developers.redhat.com/blog/2020/08/18/iptables-the-two-variants-and-their-relationship-with-nftables/>https://developers.redhat.com/blog/2020/08/18/iptables-the-two-variants-and-their-relationship-with-nftables/</a></li></ol></article></div></body></html>